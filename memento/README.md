# 备忘录模式

## 意图

在不破坏对象封装性的基础上，捕获对象的内部状态，并把该状态存放到对象之外，以后可以把该对象的状态恢复到之前保存的状态。p624

## 结构图

![image](https://github.com/yantianpi/designMode/raw/master/memento/structure.png)

## 备忘录中角色介绍

* 备忘录（Memento）角色，储存发起人对象的内部状态，由发起人决定存储哪些内部状态，备忘录保护其内容不被发起人以外的任何对象读取
* 发起人（Originator）角色，创建含有对象当前内部状态的备忘录对象，备忘录对象存储其内部状态
* 负责人（Caretaker）角色，负责保存备忘录对象，不检查备忘录对象的内容

## 备忘录优点

* 发起人对象内部信息保存在外部，帮助维护内聚，由发起人对象自己读取解析
* 发起人不需要保存内部状态的一个个版本信息，客户端可以自行管理它们所需要的这些状态的版本
* 发起人状态改变后，可以使用暂存的备忘录恢复之前的状态

## 备忘录缺点

* 如果发起人需要将状态完整的保存到备忘录中，备忘录的资源消耗比较大，耗时
* 当负责人将备忘录存储起来的时候，不知道备忘录需要多大的资源开销，不能提醒用户这个操作的代价
* 当发起人的状态改变后，这个备忘录很可能就无效了

## 备忘录适用场景

保存某一对象某一时刻的状态（快照），方便以后恢复，比如存储游戏进度

[参考](http://www.phppan.com/2010/10/php-design-pattern-18-memento/)