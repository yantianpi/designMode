# 观察者模式

## 意图

定义对象间的一种一对多的依赖关系，当一个对象状态发生改变时，依赖它的多个对象可以收到通知并作出适当更新，又称发布-订阅模式，模型-视图模式，源-监听模式，从属者模式

## 结构图

![image](https://github.com/yantianpi/designMode/raw/master/observer/structure.png)

## 观察者中角色介绍

* 抽象主题（Subject）角色，将所有观察者对象引用保存到一个集合中，一个主题可以有任意个观察者，抽象主题提供了新增和删除观察者的接口
* 抽象观察者（Observer）角色，为所有观察者提供一个公用接口，当观察的主题发生改变时更新观察者
* 具体主题（ConcreteSubject）角色，存储相关状态到具体观察者对象，当具体主题的状态发生改变时，给所有登记过的观察者发出通知
* 具体观察者（ConcreteObserver）角色，存储一个具体主题对象，存储相关状态，实现抽象观察者要求的更新接口，使得自身状态和主题状态保持一致

## 观察者优点

* 观察者和主题间松耦合
* 广播通信

## 观察者缺点

* 观察者相互之间不知道对方存在，如果通过某一观察者去改变主题的状态，不知道涉及的观察者范围，可能会引起意外更新

## 观察者适用场景

* 当对一个对象的改变需要同时改变其他对象，但又不知道具体有多少个对象需要联动改变
* 当对一个对象的改变需要同时改变其他对象，但又不能一开始就确定其他对象，换句话说，不希望联动改变是紧耦合的

[参考](http://www.phppan.com/2010/09/php-design-pattern-17-observer/)