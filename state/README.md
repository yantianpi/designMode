# 状态模式

## 意图

允许对象在内部状态改变时改变它的行为，对象看起来好像修改了它的类。p385

## 结构图

![image](https://github.com/yantianpi/designMode/raw/master/state/structure.png)

## 状态中角色介绍

* 抽象状态（State）角色，定义一个接口，涵盖了环境对象在不同状态下通用的行为
* 具体状态（ConcreteState）角色，每一个状态封装成一个类，实现抽象状态，根据自身特点实现特定行为
* 环境（Context）角色，定义客户端感兴趣的应用，内部包含了该应用拥有的所有状态对象，该应用在不同状态下的行为不同

## 状态优点

* 与特定状态相关的行为局部化，减少if判断

## 状态缺点

* 状态模式会新增很多状态类，每一个状态都需要新建一个类
* State不可被共享，原因状态对象和环境对象持有交叉引用，共享存在问题

## 适用场景

* 对象行为取决于自身状态，在运行时根据状态的改变而改变具体行为
* 一个操作中含有数量庞大的多分支语句，这些分支语句依赖于对象的状态，多个操作中都包含类似的多分支语句。状态模式将状态条件分支具象为一个个状态对象，状态对象的行为不依赖其他状态对象而独立变化

## 与其他模式对比

* 与策略模式，两者相似，但意图不同，策略模式用行为或算法来配置Context类，状态模式允许Context随着状体改变而改变行为

[参考](http://www.phppan.com/2010/07/php-design-pattern-11-state/)